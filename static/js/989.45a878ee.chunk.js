"use strict";(self.webpackChunkinstagram=self.webpackChunkinstagram||[]).push([[989],{795:function(e,n,t){t.d(n,{Z:function(){return m}});var r=t(4165),s=t(5861),a=t(9439),o=t(1413),i=t(2791),c=t(2798),l=1,u=2,d=3,f=function(e,n){switch(n.type){case l:return(0,o.Z)((0,o.Z)({},e),{},{loading:!0});case d:return{following:!e.following,loading:!1,error:!1};default:return(0,o.Z)((0,o.Z)({},e),{},{error:!0,loading:!1})}};function m(e,n,t){var o=(0,i.useReducer)(f,{following:t,loading:!1}),m=(0,a.Z)(o,2),p=m[0],h=m[1],x=function(){var t=(0,s.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,h({type:l}),t.next=4,(0,c.LN)(e.username,n,!p.following);case 4:h({type:d}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),h({type:u});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();return{followState:p,handleFollow:x}}},2989:function(e,n,t){t.r(n),t.d(n,{default:function(){return U}});var r=t(4165),s=t(5861),a=t(9439),o=t(2791),i=t(184);function c(){return(0,i.jsxs)("div",{className:"flex items-center justify-center flex-col gap-4 p-5",children:[(0,i.jsx)("img",{src:"/instagram-clone/images/tick1.png",alt:"tick",className:"w-10 h-10 sm:w-20 sm:h-20 select-none"}),(0,i.jsxs)("div",{className:"flex flex-col justify-center items-center",children:[(0,i.jsx)("h1",{className:"font-light text-2xl text-center",children:"You're all caught up"}),(0,i.jsx)("h2",{className:" text-md font-semibold text-center",children:"Follow more people to get more posts."})]})]})}var l=t(1413),u=t(4925),d=t(2798),f={post:null,likeCount:0,userLiked:!1},m=function(e,n){return(0,l.Z)((0,l.Z)({},e),n)},p=function(e,n){return!!e.filter((function(e){return e===n})).length};function h(e){var n=e.likeCount,t=e.userLiked,c=e.doLike,l=e.dispatch,u=(0,o.useState)(t),d=(0,a.Z)(u,2),f=d[0],m=d[1];return(0,o.useEffect)((function(){f!==t&&(0,s.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c(f);case 3:l({userLiked:!t,likeCount:n+Math.pow(-1,Number(!f))}),e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0.message),m((function(e){return!e}));case 10:case"end":return e.stop()}}),e,null,[[0,6]])})))()}),[f]),(0,i.jsxs)("div",{className:"flex items-start flex-col p-3 pb-0 ",children:[(0,i.jsxs)("div",{className:"flex items-start gap-x-3",children:[(0,i.jsx)("svg",{onClick:function(){return m((function(e){return!e}))},className:"w-6 h-6 ".concat(f&&"fill-red text-red"),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"})}),(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 20.25c4.97 0 9-3.694 9-8.25s-4.03-8.25-9-8.25S3 7.444 3 12c0 2.104.859 4.023 2.273 5.48.432.447.74 1.04.586 1.641a4.483 4.483 0 01-.923 1.785A5.969 5.969 0 006 21c1.282 0 2.47-.402 3.445-1.087.81.22 1.668.337 2.555.337z"})})]}),(0,i.jsx)("h1",{className:"font-bold pl-1 select-none",children:"".concat(n," like").concat(1===n?"":"s")})]})}var x=t(2579);function v(e){var n=e.imageUrl,t=(0,o.useState)(!0),r=(0,a.Z)(t,2),s=r[0],c=r[1];return(0,i.jsxs)("div",{className:"w-full",children:[s&&(0,i.jsx)(x.Z,{className:"w-full aspect-square"}),(0,i.jsx)("img",{src:n,alt:"img",className:"w-full object-cover aspect-square select-none",onLoad:function(){return c(!1)}})]})}var g=t(3433);function j(e){var n=e.seconds,t=e.nanoseconds,r=6e4,s=36e5,a=864e5,o=2592e6,i=31536e6,c=Date.now()-1e3*(n+1e-9*t);return c<r?Math.round(c/1e3)+" seconds ago":c<s?Math.round(c/r)+" minutes ago":c<a?Math.round(c/s)+" hours ago":c<o?Math.round(c/a)+" days ago":c<i?Math.round(c/o)+" months ago":Math.round(c/i)+" years ago"}var w=t(6206);function Z(e){var n=e.comments,t=e.postedAt,r=e.postId,s=(0,o.useState)(""),c=(0,a.Z)(s,2),l=c[0],u=c[1],f=(0,o.useState)(n.slice(-3)),m=(0,a.Z)(f,2),p=m[0],h=m[1],x=(0,o.useContext)(w.Z).username;return(0,i.jsxs)("div",{className:"pt-1",children:[(0,i.jsx)("ul",{className:"flex flex-col gap-y-1 pb-1",children:p.map((function(e,n){return(0,i.jsxs)("li",{className:"flex items-center justify-start gap-x-2 px-4 ",children:[(0,i.jsx)("h2",{className:"font-semibold",children:e.username}),(0,i.jsx)("p",{children:e.comment})]},n)}))}),(0,i.jsx)("p",{className:"text-gray-500 text-xs px-4 pb-2",children:j(t)}),(0,i.jsxs)("form",{onSubmit:function(e){e.preventDefault(),(0,d.fX)(r,x,l).then((function(){return h((function(e){return[].concat((0,g.Z)(e.slice(-2)),[{username:x,comment:l}])}))})).finally((function(){return u("")}))},className:"flex items-center w-full pr-4 bg-lightGray border-t",children:[(0,i.jsx)("input",{value:l,className:"w-full p-4 outline-none grow ",placeholder:"Add comment...",onChange:function(e){return u(e.target.value)}}),(0,i.jsx)("button",{disabled:""===l,className:"".concat(l?"text-blue":"text-gray-300"," bg-white font-semibold"),children:"Post"})]})]})}function b(e){var n=e.isLoading,t=e.children;return(0,i.jsx)("div",{className:"border rounded w-full mb-5",children:n?(0,i.jsx)(x.Z,{className:"w-full aspect-[4/5]"}):t})}var y=t(1087),N=t(3924),k=t(8155);function C(e){var n=e.postedBy;return(0,i.jsxs)("div",{className:"border-b flex items-center justify-start p-3",children:[(0,i.jsx)("img",{src:n.profileUrl||"/instagram-clone/DEFAULT.png",className:"w-6 h-6 rounded-full overflow-hidden",alt:"no-profile"}),(0,i.jsx)("div",{className:"grow",children:(0,i.jsx)(y.rU,{to:(0,N.Gn)(k.ih,{username:n.username}),children:(0,i.jsxs)("h1",{className:"font-semibold text-md pl-2 flex items-center justify-start gap-1",children:[n.username,n.isOfficial&&(0,i.jsx)("span",{children:(0,i.jsx)("img",{className:"w-3 inline-block",src:"/instagram-clone/images/verified.png",alt:"verified"})})]})})})]})}var L=["post"],E=(0,o.memo)((function(e){var n=e.userId,t=e.postId,c=function(e,n){var t=(0,o.useReducer)(m,f),i=(0,a.Z)(t,2),c=i[0],u=i[1];(0,o.useEffect)((function(){var t=function(){var t=(0,s.Z)((0,r.Z)().mark((function t(){var s;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,d.xl)(n);case 2:(s=t.sent)&&u({post:s,likeCount:s.likes.length,userLiked:p(s.likes,e)});case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()}),[n,e]);var h=function(){var t=(0,s.Z)((0,r.Z)().mark((function t(s){return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,d.n9)(n,e,s);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,l.Z)((0,l.Z)({},c),{},{doLike:h,dispatch:u})}(n,t),x=c.post,g=(0,u.Z)(c,L);return(0,i.jsxs)(b,{isLoading:!x,children:[(0,i.jsx)(C,{postedBy:null===x||void 0===x?void 0:x.postedBy}),(0,i.jsx)(v,{imageUrl:null===x||void 0===x?void 0:x.imageUrl}),(0,i.jsx)(h,(0,l.Z)({},g)),(0,i.jsx)(Z,{comments:null===x||void 0===x?void 0:x.comments,postedAt:null===x||void 0===x?void 0:x.postedAt,postId:t})]})})),S=t(795);function M(e){var n=e.profile,t=(0,o.useContext)(w.Z),r=(0,S.Z)(t,n.username,!1),s=r.followState,a=r.handleFollow;return(0,i.jsxs)("div",{className:"flex items-center justify-center p-1  w-48",children:[(0,i.jsx)("div",{className:"w-10 h-10 flex items-center justify-center",children:(0,i.jsx)("img",{src:n.profileUrl||"/instagram-clone/DEFAULT.png",alt:n.username+"-profile-pic",className:"w-6 aspect-square rounded-full"})}),(0,i.jsxs)("div",{className:"grow flex  items-center justify-between",children:[(0,i.jsx)(y.rU,{to:(0,N.Gn)(k.ih,{username:n.username}),children:(0,i.jsx)("h1",{className:"font-semibold text-md cursor-pointer",children:n.username})}),(0,i.jsx)("h3",{onClick:a,disabled:s.loading,className:"font-bold text-blue cursor-pointer",children:s.following?"Following":"Follow"})]})]})}var O={suggestedProfiles:[],loading:!0},A=function(e,n){return(0,l.Z)((0,l.Z)({},e),n)};function I(e){var n=e.username,t=(0,o.useReducer)(A,O),c=(0,a.Z)(t,2),l=c[0],u=c[1];return(0,o.useEffect)((function(){var e=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.vt)(n);case 2:t=e.sent,console.log(t),u({suggestedProfiles:t,loading:!1});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[n]),(0,i.jsxs)("div",{className:"p-4 hidden sm:block",children:[(0,i.jsx)("h1",{className:"font-semibold",children:"Suggestion for you"}),l.loading?(0,i.jsx)(x.Z,{count:4,className:"p-1 mt-1"}):l.suggestedProfiles.map((function(e){return(0,i.jsx)(M,{profile:e},e.username)}))]})}t(3446);function U(){var e=(0,o.useContext)(w.Z),n=(0,o.useState)(null),t=(0,a.Z)(n,2),l=t[0],u=t[1];return(0,o.useEffect)((function(){var n=function(){var n=(0,s.Z)((0,r.Z)().mark((function n(){var t;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,d.GG)(e.username);case 2:t=n.sent,console.log("feed",t),u(t);case 5:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();n()}),[]),(0,i.jsxs)("div",{className:"grid grid-cols-3 p-2 max-w-[42rem] mx-auto grow",children:[(0,i.jsxs)("div",{className:"col-span-3 sm:col-span-2 p-5 overflow-auto",children:[l?l.map((function(n){return(0,i.jsx)(E,{userId:e.username,postId:n},n)})):(0,i.jsx)(x.Z,{className:"aspect-[4/5] mb-5",count:2}),(0,i.jsx)("hr",{}),(0,i.jsx)(c,{})]}),(0,i.jsx)(I,{username:e.username})]})}},4925:function(e,n,t){function r(e,n){if(null==e)return{};var t,r,s=function(e,n){if(null==e)return{};var t,r,s={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(s[t]=e[t]);return s}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}t.d(n,{Z:function(){return r}})},2579:function(e,n,t){t.d(n,{Z:function(){return l}});var r=t(9439),s=t(1413),a=t(4925),o=t(2791),i=["count","wrapper","className","containerClassName","containerTestId","circle","style"],c=o.createContext({});function l(e){for(var n,t,l,u=e.count,d=void 0===u?1:u,f=e.wrapper,m=e.className,p=e.containerClassName,h=e.containerTestId,x=e.circle,v=void 0!==x&&x,g=e.style,j=(0,a.Z)(e,i),w=o.useContext(c),Z=(0,s.Z)({},j),b=0,y=Object.entries(j);b<y.length;b++){var N=(0,r.Z)(y[b],2),k=N[0];"undefined"===typeof N[1]&&delete Z[k]}var C=(0,s.Z)((0,s.Z)((0,s.Z)({},w),Z),{},{circle:v}),L=(0,s.Z)((0,s.Z)({},g),function(e){var n=e.baseColor,t=e.highlightColor,r=e.width,s=e.height,a=e.borderRadius,o=e.circle,i=e.direction,c=e.duration,l=e.enableAnimation,u=void 0===l||l,d={};return"rtl"===i&&(d["--animation-direction"]="reverse"),"number"===typeof c&&(d["--animation-duration"]="".concat(c,"s")),u||(d["--pseudo-element-display"]="none"),"string"!==typeof r&&"number"!==typeof r||(d.width=r),"string"!==typeof s&&"number"!==typeof s||(d.height=s),"string"!==typeof a&&"number"!==typeof a||(d.borderRadius=a),o&&(d.borderRadius="50%"),"undefined"!==typeof n&&(d["--base-color"]=n),"undefined"!==typeof t&&(d["--highlight-color"]=t),d}(C)),E="react-loading-skeleton";m&&(E+=" ".concat(m));for(var S=null!==(n=C.inline)&&void 0!==n&&n,M=[],O=Math.ceil(d),A=0;A<O;A++){var I=L;if(O>d&&A===O-1){var U=null!==(t=I.width)&&void 0!==t?t:"100%",F=d%1,P="number"===typeof U?U*F:"calc(".concat(U," * ").concat(F,")");I=(0,s.Z)((0,s.Z)({},I),{},{width:P})}var R=o.createElement("span",{className:E,style:I,key:A},"\u200c");S?M.push(R):M.push(o.createElement(o.Fragment,{key:A},R,o.createElement("br",null)))}return o.createElement("span",{className:p,"data-testid":h,"aria-live":"polite","aria-busy":null===(l=C.enableAnimation)||void 0===l||l},f?M.map((function(e,n){return o.createElement(f,{key:n},e)})):M)}}}]);
//# sourceMappingURL=989.45a878ee.chunk.js.map